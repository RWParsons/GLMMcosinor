<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="GLMMcosinor">
<title>model-specification • GLMMcosinor</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="model-specification">
<meta property="og:description" content="GLMMcosinor">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">GLMMcosinor</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/GLMMcosinor.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/data-simulations.html">data-simulations</a>
    <a class="dropdown-item" href="../articles/mixed-models.html">mixed-models</a>
    <a class="dropdown-item" href="../articles/model-specification.html">model-specification</a>
    <a class="dropdown-item" href="../articles/model-visualisations.html">model-visualisations</a>
    <a class="dropdown-item" href="../articles/multiple-components.html">multiple-components</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/RWParsons/GLMMcosinor/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>model-specification</h1>
                        <h4 data-toc-skip class="author">Oliver
Jayasinghe and Rex Parsons</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/RWParsons/GLMMcosinor/blob/HEAD/vignettes/model-specification.Rmd" class="external-link"><code>vignettes/model-specification.Rmd</code></a></small>
      <div class="d-none name"><code>model-specification.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RWParsons/GLMMcosinor" class="external-link">GLMMcosinor</a></span><span class="op">)</span></span>
<span><span class="co">#' @srrstats {G2.0a} Provide explicit secondary documentation of any expectations on lengths of inputs</span></span>
<span><span class="co">#' @srrstats {G2.1a} *Provide explicit secondary documentation of expectations on data types of all vector inputs.*</span></span></code></pre></div>
<div class="section level2">
<h2 id="using-cosinor-glmm-r">Using: ‘cosinor.glmm.R’<a class="anchor" aria-label="anchor" href="#using-cosinor-glmm-r"></a>
</h2>
<p>cosinor.glmm() generates a regression model with parameter estimates
based on a data set and formula specified by the user.</p>
<p>The formula argument for cosinor.glmm() is constructed in two
parts:</p>
<p>Firstly: specification of any intercept or covariate mesor terms. By
default, an intercept term is included but this can be removed by
including a 0 in the formula. For example, the following formula has an
intercept and X listed as a covariate mesor term:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">vitamind</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/cosinor.glmm.html">cosinor.glmm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">time</span>, group <span class="op">=</span> <span class="st">"X"</span>, period <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">vitamind</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Conditional Model </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw formula: </span></span>
<span><span class="co">#&gt; Y ~ X + X:main_rrr1 + X:main_sss1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw Coefficients: </span></span>
<span><span class="co">#&gt;              Estimate</span></span>
<span><span class="co">#&gt; (Intercept)  29.68980</span></span>
<span><span class="co">#&gt; X1            1.90186</span></span>
<span><span class="co">#&gt; X0:main_rrr1  0.93079</span></span>
<span><span class="co">#&gt; X1:main_rrr1  6.51029</span></span>
<span><span class="co">#&gt; X0:main_sss1  6.20099</span></span>
<span><span class="co">#&gt; X1:main_sss1  4.81846</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Transformed Coefficients: </span></span>
<span><span class="co">#&gt;             Estimate</span></span>
<span><span class="co">#&gt; (Intercept) 29.68980</span></span>
<span><span class="co">#&gt; [X=1]        1.90186</span></span>
<span><span class="co">#&gt; [X=0]:amp    6.27046</span></span>
<span><span class="co">#&gt; [X=1]:amp    8.09947</span></span>
<span><span class="co">#&gt; [X=0]:acr   -1.42181</span></span>
<span><span class="co">#&gt; [X=1]:acr   -0.63715</span></span></code></pre></div>
<p>Alternatively, the following example will have no intercept term, but
will still generate a mesor estimate for the X group. In the output, the
[X=0] and [X=1] refer to estimates of mesor for the levels 0 and 1
respectively within the group “X”.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cosinor.glmm.html">cosinor.glmm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">X</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">time</span>, group <span class="op">=</span> <span class="st">"X"</span>, period <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">vitamind</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Conditional Model </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw formula: </span></span>
<span><span class="co">#&gt; Y ~ X + X:main_rrr1 + X:main_sss1 - 1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw Coefficients: </span></span>
<span><span class="co">#&gt;              Estimate</span></span>
<span><span class="co">#&gt; X0           29.68980</span></span>
<span><span class="co">#&gt; X1           31.59165</span></span>
<span><span class="co">#&gt; X0:main_rrr1  0.93079</span></span>
<span><span class="co">#&gt; X1:main_rrr1  6.51029</span></span>
<span><span class="co">#&gt; X0:main_sss1  6.20101</span></span>
<span><span class="co">#&gt; X1:main_sss1  4.81847</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Transformed Coefficients: </span></span>
<span><span class="co">#&gt;           Estimate</span></span>
<span><span class="co">#&gt; [X=0]     29.68980</span></span>
<span><span class="co">#&gt; [X=1]     31.59165</span></span>
<span><span class="co">#&gt; [X=0]:amp  6.27048</span></span>
<span><span class="co">#&gt; [X=1]:amp  8.09948</span></span>
<span><span class="co">#&gt; [X=0]:acr -1.42181</span></span>
<span><span class="co">#&gt; [X=1]:acr -0.63716</span></span></code></pre></div>
<p>Finally, the following will have no intercept term, nor will it
generate any mesor estimates:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cosinor.glmm.html">cosinor.glmm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">time</span>, group <span class="op">=</span> <span class="st">"X"</span>, period <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">vitamind</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Conditional Model </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw formula: </span></span>
<span><span class="co">#&gt; Y ~ X:main_rrr1 + X:main_sss1 - 1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw Coefficients: </span></span>
<span><span class="co">#&gt;              Estimate</span></span>
<span><span class="co">#&gt; X0:main_rrr1  3.98682</span></span>
<span><span class="co">#&gt; X1:main_rrr1  5.66053</span></span>
<span><span class="co">#&gt; X0:main_sss1  4.17943</span></span>
<span><span class="co">#&gt; X1:main_sss1  1.03582</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Transformed Coefficients: </span></span>
<span><span class="co">#&gt;           Estimate</span></span>
<span><span class="co">#&gt; [X=0]:amp  5.77602</span></span>
<span><span class="co">#&gt; [X=1]:amp  5.75452</span></span>
<span><span class="co">#&gt; [X=0]:acr -0.80898</span></span>
<span><span class="co">#&gt; [X=1]:acr -0.18099</span></span></code></pre></div>
<p>Secondly, specification of the amp_acro() function. The amp_acro()
function modifies the original dataset and formula so that the amplitude
and acrophase can be calculated. Importantly, the amp_acro() argument is
where users specify:</p>
<ul>
<li><p>‘group’ (the name of the group covariates). Ensure that the names
in this argument are actually found in the dataset. The group argument
can be an object or a string.</p></li>
<li><p>‘time’ (the name of the time column). Ensure that the name
matches the name of the time values in the dataset. The ‘time’ argument
can be an object or a string.</p></li>
<li><p>‘n_components’ (The number of components). If the user wishes to
have a more than one trigonometric component in the model, they can
specify the number of such components here. Note that this value will
need to match the length of the group argument and the period argument.
For example, if n_components = 3, then the group argument should have 3
characters, where the position of each character corresponds to the
component that the group covariate describes:<br></p></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">vitamind</span><span class="op">)</span></span>
<span><span class="va">vitamind</span><span class="op">$</span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">vitamind</span><span class="op">$</span><span class="va">X</span><span class="op">)</span>, <span class="fl">1</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/cosinor.glmm.html">cosinor.glmm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">time</span>, n_components <span class="op">=</span> <span class="fl">3</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="cn">NA</span>, <span class="st">"Z"</span><span class="op">)</span>, period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">10</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">vitamind</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Conditional Model </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw formula: </span></span>
<span><span class="co">#&gt; Y ~ X + main_rrr2 + main_sss2 + X:main_rrr1 + X:main_sss1 + Z:main_rrr3 +      Z:main_sss3 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw Coefficients: </span></span>
<span><span class="co">#&gt;               Estimate</span></span>
<span><span class="co">#&gt; (Intercept)   31.18664</span></span>
<span><span class="co">#&gt; X1             1.98359</span></span>
<span><span class="co">#&gt; main_rrr2    -16.07251</span></span>
<span><span class="co">#&gt; main_sss2     -0.91549</span></span>
<span><span class="co">#&gt; X0:main_rrr1  12.47484</span></span>
<span><span class="co">#&gt; X1:main_rrr1  18.24309</span></span>
<span><span class="co">#&gt; X0:main_sss1   0.63659</span></span>
<span><span class="co">#&gt; X1:main_sss1  -1.24034</span></span>
<span><span class="co">#&gt; Z0:main_rrr3   2.18491</span></span>
<span><span class="co">#&gt; Z1:main_rrr3   5.23826</span></span>
<span><span class="co">#&gt; Z0:main_sss3   2.45037</span></span>
<span><span class="co">#&gt; Z1:main_sss3   3.63285</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Transformed Coefficients: </span></span>
<span><span class="co">#&gt;             Estimate</span></span>
<span><span class="co">#&gt; (Intercept) 31.18664</span></span>
<span><span class="co">#&gt; [X=1]        1.98359</span></span>
<span><span class="co">#&gt; [X=0]:amp1  12.49107</span></span>
<span><span class="co">#&gt; [X=1]:amp1  18.28521</span></span>
<span><span class="co">#&gt; amp2        16.09856</span></span>
<span><span class="co">#&gt; [Z=0]:amp3   3.28301</span></span>
<span><span class="co">#&gt; [Z=1]:amp3   6.37471</span></span>
<span><span class="co">#&gt; [X=0]:acr1  -0.05099</span></span>
<span><span class="co">#&gt; [X=1]:acr1   0.06788</span></span>
<span><span class="co">#&gt; acr2         3.08469</span></span>
<span><span class="co">#&gt; [Z=0]:acr3  -0.84260</span></span>
<span><span class="co">#&gt; [Z=1]:acr3  -0.60636</span></span></code></pre></div>
<p>As demonstrated in the example above, the ‘NA’ entry in the group
argument indicates a component with no group covariate assigned.</p>
<p>If only one group argument and and/or one period argument is
supplied, but there is more than one component specified, then it will
be assumed that the one group and one period specified applies to all
components:</p>
<p>For instance, the following two cosinor.glmm() calls produce the same
output:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cosinor.glmm.html">cosinor.glmm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">time</span>, n_components <span class="op">=</span> <span class="fl">3</span>, group <span class="op">=</span> <span class="st">"X"</span>, period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">vitamind</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Conditional Model </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw formula: </span></span>
<span><span class="co">#&gt; Y ~ X + X:main_rrr1 + X:main_sss1 + X:main_rrr2 + X:main_sss2 +      X:main_rrr3 + X:main_sss3 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw Coefficients: </span></span>
<span><span class="co">#&gt;              Estimate</span></span>
<span><span class="co">#&gt; (Intercept)  29.68979</span></span>
<span><span class="co">#&gt; X1            1.90186</span></span>
<span><span class="co">#&gt; X0:main_rrr1  0.31026</span></span>
<span><span class="co">#&gt; X1:main_rrr1  2.17010</span></span>
<span><span class="co">#&gt; X0:main_sss1  2.06700</span></span>
<span><span class="co">#&gt; X1:main_sss1  1.60615</span></span>
<span><span class="co">#&gt; X0:main_rrr2  0.31026</span></span>
<span><span class="co">#&gt; X1:main_rrr2  2.17010</span></span>
<span><span class="co">#&gt; X0:main_sss2  2.06700</span></span>
<span><span class="co">#&gt; X1:main_sss2  1.60615</span></span>
<span><span class="co">#&gt; X0:main_rrr3  0.31026</span></span>
<span><span class="co">#&gt; X1:main_rrr3  2.17010</span></span>
<span><span class="co">#&gt; X0:main_sss3  2.06700</span></span>
<span><span class="co">#&gt; X1:main_sss3  1.60615</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Transformed Coefficients: </span></span>
<span><span class="co">#&gt;             Estimate</span></span>
<span><span class="co">#&gt; (Intercept) 29.68979</span></span>
<span><span class="co">#&gt; [X=1]        1.90186</span></span>
<span><span class="co">#&gt; [X=0]:amp1   2.09015</span></span>
<span><span class="co">#&gt; [X=1]:amp1   2.69982</span></span>
<span><span class="co">#&gt; [X=0]:amp2   2.09015</span></span>
<span><span class="co">#&gt; [X=1]:amp2   2.69982</span></span>
<span><span class="co">#&gt; [X=0]:amp3   2.09015</span></span>
<span><span class="co">#&gt; [X=1]:amp3   2.69982</span></span>
<span><span class="co">#&gt; [X=0]:acr1  -1.42181</span></span>
<span><span class="co">#&gt; [X=1]:acr1  -0.63715</span></span>
<span><span class="co">#&gt; [X=0]:acr2  -1.42181</span></span>
<span><span class="co">#&gt; [X=1]:acr2  -0.63715</span></span>
<span><span class="co">#&gt; [X=0]:acr3  -1.42181</span></span>
<span><span class="co">#&gt; [X=1]:acr3  -0.63715</span></span>
<span></span>
<span><span class="fu"><a href="../reference/cosinor.glmm.html">cosinor.glmm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">time</span>, n_components <span class="op">=</span> <span class="fl">3</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="st">"X"</span>, <span class="st">"X"</span><span class="op">)</span>, period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">12</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">vitamind</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Conditional Model </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw formula: </span></span>
<span><span class="co">#&gt; Y ~ X + X:main_rrr1 + X:main_sss1 + X:main_rrr2 + X:main_sss2 +      X:main_rrr3 + X:main_sss3 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw Coefficients: </span></span>
<span><span class="co">#&gt;              Estimate</span></span>
<span><span class="co">#&gt; (Intercept)  29.68979</span></span>
<span><span class="co">#&gt; X1            1.90186</span></span>
<span><span class="co">#&gt; X0:main_rrr1  0.31026</span></span>
<span><span class="co">#&gt; X1:main_rrr1  2.17010</span></span>
<span><span class="co">#&gt; X0:main_sss1  2.06700</span></span>
<span><span class="co">#&gt; X1:main_sss1  1.60615</span></span>
<span><span class="co">#&gt; X0:main_rrr2  0.31026</span></span>
<span><span class="co">#&gt; X1:main_rrr2  2.17010</span></span>
<span><span class="co">#&gt; X0:main_sss2  2.06700</span></span>
<span><span class="co">#&gt; X1:main_sss2  1.60615</span></span>
<span><span class="co">#&gt; X0:main_rrr3  0.31026</span></span>
<span><span class="co">#&gt; X1:main_rrr3  2.17010</span></span>
<span><span class="co">#&gt; X0:main_sss3  2.06700</span></span>
<span><span class="co">#&gt; X1:main_sss3  1.60615</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Transformed Coefficients: </span></span>
<span><span class="co">#&gt;             Estimate</span></span>
<span><span class="co">#&gt; (Intercept) 29.68979</span></span>
<span><span class="co">#&gt; [X=1]        1.90186</span></span>
<span><span class="co">#&gt; [X=0]:amp1   2.09015</span></span>
<span><span class="co">#&gt; [X=1]:amp1   2.69982</span></span>
<span><span class="co">#&gt; [X=0]:amp2   2.09015</span></span>
<span><span class="co">#&gt; [X=1]:amp2   2.69982</span></span>
<span><span class="co">#&gt; [X=0]:amp3   2.09015</span></span>
<span><span class="co">#&gt; [X=1]:amp3   2.69982</span></span>
<span><span class="co">#&gt; [X=0]:acr1  -1.42181</span></span>
<span><span class="co">#&gt; [X=1]:acr1  -0.63715</span></span>
<span><span class="co">#&gt; [X=0]:acr2  -1.42181</span></span>
<span><span class="co">#&gt; [X=1]:acr2  -0.63715</span></span>
<span><span class="co">#&gt; [X=0]:acr3  -1.42181</span></span>
<span><span class="co">#&gt; [X=1]:acr3  -0.63715</span></span></code></pre></div>
<div class="section level3">
<h3 id="dispersion-and-zero-inflation-model-specification">Dispersion and zero-inflation model specification<a class="anchor" aria-label="anchor" href="#dispersion-and-zero-inflation-model-specification"></a>
</h3>
<p>The cosinor.glmm() function optionally allows users to specify
formulas for dispersion and zero-inflation models. These formulas are
independent of the main formula specification:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">testdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_cosinor.html">simulate_cosinor</a></span><span class="op">(</span><span class="fl">1000</span>, n_period <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  mesor <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  amp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  acro <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.5</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  beta.mesor <span class="op">=</span> <span class="fl">4.4</span>,</span>
<span>  beta.amp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>  beta.acro <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1.5</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>  period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">6</span>, <span class="fl">8</span><span class="op">)</span>,</span>
<span>  n_components <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span>
<span><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cosinor.glmm.html">cosinor.glmm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">group</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">times</span>,</span>
<span>  n_components <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">6</span>, <span class="fl">8</span><span class="op">)</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"group"</span></span>
<span><span class="op">)</span>, data <span class="op">=</span> <span class="va">testdata</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>  dispformula <span class="op">=</span> <span class="op">~</span> <span class="va">group</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">times</span>, n_components <span class="op">=</span> <span class="fl">2</span>, group <span class="op">=</span> <span class="st">"group"</span>, period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span>, </span>
<span>  ziformula <span class="op">=</span> <span class="op">~</span> <span class="va">group</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">times</span>, n_components <span class="op">=</span> <span class="fl">3</span>, group <span class="op">=</span> <span class="st">"group"</span>, period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">object</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Conditional Model </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw formula: </span></span>
<span><span class="co">#&gt; Y ~ group + group:main_rrr1 + group:main_sss1 + group:main_rrr2 +      group:main_sss2 + group:main_rrr3 + group:main_sss3 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw Coefficients: </span></span>
<span><span class="co">#&gt;                  Estimate</span></span>
<span><span class="co">#&gt; (Intercept)       7.05206</span></span>
<span><span class="co">#&gt; group1           -2.62269</span></span>
<span><span class="co">#&gt; group0:main_rrr1  0.01678</span></span>
<span><span class="co">#&gt; group1:main_rrr1  1.02569</span></span>
<span><span class="co">#&gt; group0:main_sss1 -0.17339</span></span>
<span><span class="co">#&gt; group1:main_sss1 -1.71145</span></span>
<span><span class="co">#&gt; group0:main_rrr2  0.00283</span></span>
<span><span class="co">#&gt; group1:main_rrr2  0.11237</span></span>
<span><span class="co">#&gt; group0:main_sss2 -0.47550</span></span>
<span><span class="co">#&gt; group1:main_sss2  1.01754</span></span>
<span><span class="co">#&gt; group0:main_rrr3  0.64736</span></span>
<span><span class="co">#&gt; group1:main_rrr3  0.24060</span></span>
<span><span class="co">#&gt; group0:main_sss3 -0.05020</span></span>
<span><span class="co">#&gt; group1:main_sss3  0.31245</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Transformed Coefficients: </span></span>
<span><span class="co">#&gt;                Estimate</span></span>
<span><span class="co">#&gt; (Intercept)     7.05206</span></span>
<span><span class="co">#&gt; [group=1]      -2.62269</span></span>
<span><span class="co">#&gt; [group=0]:amp1  0.17420</span></span>
<span><span class="co">#&gt; [group=1]:amp1  1.99527</span></span>
<span><span class="co">#&gt; [group=0]:amp2  0.47550</span></span>
<span><span class="co">#&gt; [group=1]:amp2  1.02373</span></span>
<span><span class="co">#&gt; [group=0]:amp3  0.64931</span></span>
<span><span class="co">#&gt; [group=1]:amp3  0.39435</span></span>
<span><span class="co">#&gt; [group=0]:acr1  1.47433</span></span>
<span><span class="co">#&gt; [group=1]:acr1  1.03088</span></span>
<span><span class="co">#&gt; [group=0]:acr2  1.56484</span></span>
<span><span class="co">#&gt; [group=1]:acr2 -1.46080</span></span>
<span><span class="co">#&gt; [group=0]:acr3  0.07740</span></span>
<span><span class="co">#&gt; [group=1]:acr3 -0.91460</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ***********************</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Dispersion Model </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw  Formula: </span></span>
<span><span class="co">#&gt; ~group + group:disp_rrr1 + group:disp_sss1 + group:disp_rrr2 +      group:disp_sss2 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw  Coefficients: </span></span>
<span><span class="co">#&gt;                  Estimate</span></span>
<span><span class="co">#&gt; (Intercept)      -0.07187</span></span>
<span><span class="co">#&gt; group1            0.11481</span></span>
<span><span class="co">#&gt; group0:disp_rrr1  0.03623</span></span>
<span><span class="co">#&gt; group1:disp_rrr1 -0.04196</span></span>
<span><span class="co">#&gt; group0:disp_sss1  0.07155</span></span>
<span><span class="co">#&gt; group1:disp_sss1 -0.03950</span></span>
<span><span class="co">#&gt; group0:disp_rrr2 -0.02835</span></span>
<span><span class="co">#&gt; group1:disp_rrr2 -0.01918</span></span>
<span><span class="co">#&gt; group0:disp_sss2  0.04293</span></span>
<span><span class="co">#&gt; group1:disp_sss2 -0.03664</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Transformed  Coefficients: </span></span>
<span><span class="co">#&gt;                Estimate</span></span>
<span><span class="co">#&gt; (Intercept)    -0.07187</span></span>
<span><span class="co">#&gt; [group=1]       0.11481</span></span>
<span><span class="co">#&gt; [group=0]:amp1  0.08020</span></span>
<span><span class="co">#&gt; [group=1]:amp1  0.05763</span></span>
<span><span class="co">#&gt; [group=0]:amp2  0.05145</span></span>
<span><span class="co">#&gt; [group=1]:amp2  0.04135</span></span>
<span><span class="co">#&gt; [group=0]:acr1 -1.10212</span></span>
<span><span class="co">#&gt; [group=1]:acr1  2.38640</span></span>
<span><span class="co">#&gt; [group=0]:acr2 -2.15447</span></span>
<span><span class="co">#&gt; [group=1]:acr2  2.05302</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ***********************</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Zero-Inflation Model </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw  Formula: </span></span>
<span><span class="co">#&gt; ~group + group:zi_rrr1 + group:zi_sss1 + group:zi_rrr2 + group:zi_sss2 +      group:zi_rrr3 + group:zi_sss3 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw  Coefficients: </span></span>
<span><span class="co">#&gt;                 Estimate</span></span>
<span><span class="co">#&gt; (Intercept)    -22.28670</span></span>
<span><span class="co">#&gt; group1          -0.64143</span></span>
<span><span class="co">#&gt; group0:zi_rrr1  -0.04796</span></span>
<span><span class="co">#&gt; group1:zi_rrr1  -0.02302</span></span>
<span><span class="co">#&gt; group0:zi_sss1  -0.03094</span></span>
<span><span class="co">#&gt; group1:zi_sss1  -0.01574</span></span>
<span><span class="co">#&gt; group0:zi_rrr2  -0.01463</span></span>
<span><span class="co">#&gt; group1:zi_rrr2  -0.01519</span></span>
<span><span class="co">#&gt; group0:zi_sss2  -0.00003</span></span>
<span><span class="co">#&gt; group1:zi_sss2   0.00225</span></span>
<span><span class="co">#&gt; group0:zi_rrr3   0.02010</span></span>
<span><span class="co">#&gt; group1:zi_rrr3   0.00960</span></span>
<span><span class="co">#&gt; group0:zi_sss3  -0.02563</span></span>
<span><span class="co">#&gt; group1:zi_sss3  -0.01404</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Transformed  Coefficients: </span></span>
<span><span class="co">#&gt;                 Estimate</span></span>
<span><span class="co">#&gt; (Intercept)    -22.28670</span></span>
<span><span class="co">#&gt; [group=1]       -0.64143</span></span>
<span><span class="co">#&gt; [group=0]:amp1   0.05708</span></span>
<span><span class="co">#&gt; [group=1]:amp1   0.02788</span></span>
<span><span class="co">#&gt; [group=0]:amp2   0.01463</span></span>
<span><span class="co">#&gt; [group=1]:amp2   0.01536</span></span>
<span><span class="co">#&gt; [group=0]:amp3   0.03257</span></span>
<span><span class="co">#&gt; [group=1]:amp3   0.01701</span></span>
<span><span class="co">#&gt; [group=0]:acr1   2.56865</span></span>
<span><span class="co">#&gt; [group=1]:acr1   2.54175</span></span>
<span><span class="co">#&gt; [group=0]:acr2   3.13977</span></span>
<span><span class="co">#&gt; [group=1]:acr2  -2.99457</span></span>
<span><span class="co">#&gt; [group=0]:acr3   0.90585</span></span>
<span><span class="co">#&gt; [group=1]:acr3   0.97086</span></span></code></pre></div>
<p>This example shows how dispformula and ziformula can be specified
with a different number of components, with different periods, and with
different group-component assignments. By default, dispformula = ~1, and
ziformula = ~0.</p>
<p><em>Note that in the example above, the value for the periods and the
number of components in the dispersion and zero-inflation formulas were
chosen arbitrarily and purely for demonstration.</em></p>
</div>
</div>
<div class="section level2">
<h2 id="using-summary-cosinor-glmm-r">Using: ‘summary.cosinor.glmm.R’<a class="anchor" aria-label="anchor" href="#using-summary-cosinor-glmm-r"></a>
</h2>
<p>The summary.cosinor.glmm() function provides summary statistics for
an object produced by the cosinor.glmm() function. It outputs the
estimates, confidence intervals, and tests for both the raw parameters
and the transformed (mesor, amplitude, and acrophase) parameters.
Currently, the summary statistics do not represent a comparison between
any groups - that is the role of the test_cosinor() function.</p>
<p>Here is an example of how to use the summary.cosinor.glmm()
function:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">vitamind</span><span class="op">)</span></span>
<span><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cosinor.glmm.html">cosinor.glmm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">time</span>, group <span class="op">=</span> <span class="st">"X"</span>, period <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">vitamind</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Conditional Model </span></span>
<span><span class="co">#&gt; Raw model coefficients:</span></span>
<span><span class="co">#&gt;                estimate standard.error   lower.CI upper.CI    p.value    </span></span>
<span><span class="co">#&gt; (Intercept)  29.6897959      0.4583696 28.7914079 30.58818 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; X1            1.9018623      0.7919688  0.3496320  3.45409   0.016331 *  </span></span>
<span><span class="co">#&gt; X0:main_rrr1  0.9307876      0.6260656 -0.2962784  2.15785   0.137087    </span></span>
<span><span class="co">#&gt; X1:main_rrr1  6.5102900      0.9303406  4.6868560  8.33372 2.6011e-12 ***</span></span>
<span><span class="co">#&gt; X0:main_sss1  6.2009896      0.6701952  4.8874311  7.51455 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; X1:main_sss1  4.8184618      0.8963299  3.0616875  6.57524 7.6257e-08 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Transformed coefficients:</span></span>
<span><span class="co">#&gt;                estimate standard.error    lower.CI upper.CI    p.value    </span></span>
<span><span class="co">#&gt; (Intercept) 29.68979587     0.45836964 28.79140787 30.58818 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [X=1]        1.90186227     0.79196879  0.34963197  3.45409   0.016331 *  </span></span>
<span><span class="co">#&gt; [X=0]:amp1   6.27045757     0.66965642  4.95795510  7.58296 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [X=1]:amp1   8.09947222     1.10283566  5.93795403 10.26099 2.0696e-13 ***</span></span>
<span><span class="co">#&gt; [X=0]:acr1  -1.42180558     0.09993559 -1.61767574 -1.22594 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [X=1]:acr1  -0.63715441     0.14043625 -0.91240440 -0.36190 5.7069e-06 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>The summary statistics for dispersion and zero-inflation models will
also be provided by the summary.cosinor.glmm() function, if the original
cosinor.glmm object being analysed contains them:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">vitamind</span><span class="op">)</span> <span class="co"># load vitamind dataset</span></span>
<span><span class="va">vitamind</span><span class="op">$</span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">vitamind</span><span class="op">$</span><span class="va">X</span><span class="op">)</span>, <span class="fl">2</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="co"># modify dataset</span></span>
<span></span>
<span><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cosinor.glmm.html">cosinor.glmm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">time</span>, n_components <span class="op">=</span> <span class="fl">3</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="cn">NA</span>, <span class="st">"Z"</span><span class="op">)</span>, period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">10</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">vitamind</span>,</span>
<span>  dispformula <span class="op">=</span> <span class="op">~</span> <span class="va">X</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">time</span>, n_components <span class="op">=</span> <span class="fl">3</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Z"</span>, <span class="cn">NA</span>, <span class="st">"X"</span><span class="op">)</span>, period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">11</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ziformula <span class="op">=</span> <span class="op">~</span> <span class="va">X</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">time</span>, n_components <span class="op">=</span> <span class="fl">2</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Z"</span>, <span class="st">"X"</span><span class="op">)</span>, period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Conditional Model </span></span>
<span><span class="co">#&gt; Raw model coefficients:</span></span>
<span><span class="co">#&gt;                 estimate standard.error    lower.CI upper.CI    p.value    </span></span>
<span><span class="co">#&gt; (Intercept)   30.2089490      3.0434309  24.2439341 36.17396 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; X1             2.1451469      0.8261093   0.5260025  3.76429  0.0094128 ** </span></span>
<span><span class="co">#&gt; main_rrr2     -8.8426032     28.2425646 -64.1970127 46.51181  0.7542086    </span></span>
<span><span class="co">#&gt; main_sss2      4.1324578     21.5663086 -38.1367304 46.40165  0.8480427    </span></span>
<span><span class="co">#&gt; X0:main_rrr1   5.4559329     26.4410402 -46.3675537 57.27942  0.8365227    </span></span>
<span><span class="co">#&gt; X1:main_rrr1  11.5285874     26.5196240 -40.4489204 63.50610  0.6637663    </span></span>
<span><span class="co">#&gt; X0:main_sss1   0.3340853      6.0938660 -11.6096726 12.27784  0.9562793    </span></span>
<span><span class="co">#&gt; X1:main_sss1  -0.4538530      6.2017937 -12.6091452 11.70144  0.9416621    </span></span>
<span><span class="co">#&gt; Z0:main_rrr3   5.3245320      4.3708476  -3.2421719 13.89124  0.2231510    </span></span>
<span><span class="co">#&gt; Z1:main_rrr3   2.2224084      4.3474133  -6.2983651 10.74318  0.6092093    </span></span>
<span><span class="co">#&gt; Z2:main_rrr3   4.1572099      4.3695368  -4.4069249 12.72134  0.3413976    </span></span>
<span><span class="co">#&gt; Z0:main_sss3   0.0376834     11.1745042 -21.8639424 21.93931  0.9973093    </span></span>
<span><span class="co">#&gt; Z1:main_sss3   0.9809324     11.2263835 -21.0223748 22.98424  0.9303715    </span></span>
<span><span class="co">#&gt; Z2:main_sss3  -0.5761092     11.1163807 -22.3638150 21.21160  0.9586679    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Transformed coefficients:</span></span>
<span><span class="co">#&gt;                  estimate standard.error      lower.CI upper.CI    p.value    </span></span>
<span><span class="co">#&gt; (Intercept)  30.208949008    3.043430896  24.243934064 36.17396 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [X=1]         2.145146936    0.826109292   0.526002477  3.76429  0.0094128 ** </span></span>
<span><span class="co">#&gt; amp2          9.760575762   18.604181460 -26.702949861 46.22410  0.5998306    </span></span>
<span><span class="co">#&gt; [X=0]:amp1    5.466151905    6.175665761  -6.637930567 17.57023  0.3760966    </span></span>
<span><span class="co">#&gt; [X=1]:amp1   11.537517526    5.745763110   0.276028768 22.79901  0.0446428 *  </span></span>
<span><span class="co">#&gt; [Z=0]:amp3    5.324665368   27.927915368 -49.413042916 60.06237  0.8487940    </span></span>
<span><span class="co">#&gt; [Z=1]:amp3    2.429264821   29.025842635 -54.460341365 59.31887  0.9333004    </span></span>
<span><span class="co">#&gt; [Z=2]:amp3    4.196938853   26.399118413 -47.544382460 55.93826  0.8736844    </span></span>
<span><span class="co">#&gt; acr2         -2.704416839    3.101860070  -8.783950860  3.37512  0.3832796    </span></span>
<span><span class="co">#&gt; [X=0]:acr1   -0.061157033    3.700381325  -7.313771160  7.19146  0.9868138    </span></span>
<span><span class="co">#&gt; [X=1]:acr1    0.039347294    1.747295460  -3.385288878  3.46398  0.9820340    </span></span>
<span><span class="co">#&gt; [Z=0]:acr3   -0.007077199    2.218768552  -4.355783650  4.34163  0.9974550    </span></span>
<span><span class="co">#&gt; [Z=1]:acr3   -0.415664645    3.460235051  -7.197600722  6.36627  0.9043832    </span></span>
<span><span class="co">#&gt; [Z=2]:acr3    0.137703678    3.541959042  -6.804408479  7.07982  0.9689878    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ***********************</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Dispersion Model </span></span>
<span><span class="co">#&gt; Raw model coefficients:</span></span>
<span><span class="co">#&gt;                   estimate standard.error      lower.CI upper.CI  p.value  </span></span>
<span><span class="co">#&gt; (Intercept)    2.686347601    1.296790146   0.144685618  5.22801 0.038309 *</span></span>
<span><span class="co">#&gt; X1             0.485499005    0.235335891   0.024249135  0.94675 0.039112 *</span></span>
<span><span class="co">#&gt; disp_rrr2      3.919538125   22.705777631 -40.582968272 48.42204 0.862948  </span></span>
<span><span class="co">#&gt; disp_sss2     10.256342677    7.495444372  -4.434458340 24.94714 0.171205  </span></span>
<span><span class="co">#&gt; Z0:disp_rrr1  -5.768529717   21.748248058 -48.394312636 36.85725 0.790824  </span></span>
<span><span class="co">#&gt; Z1:disp_rrr1  -6.058241451   21.746557592 -48.680711118 36.56423 0.780564  </span></span>
<span><span class="co">#&gt; Z2:disp_rrr1  -5.691695659   21.664744574 -48.153814758 36.77042 0.792769  </span></span>
<span><span class="co">#&gt; Z0:disp_sss1  -7.509008761    4.468057787 -16.266241104  1.24822 0.092841 .</span></span>
<span><span class="co">#&gt; Z1:disp_sss1  -7.056210666    4.434444412 -15.747562006  1.63514 0.111558  </span></span>
<span><span class="co">#&gt; Z2:disp_sss1  -7.440080380    4.446822655 -16.155692629  1.27553 0.094303 .</span></span>
<span><span class="co">#&gt; X0:disp_rrr3   2.057435954    1.054223424  -0.008803989  4.12368 0.050984 .</span></span>
<span><span class="co">#&gt; X1:disp_rrr3   1.512786113    1.038329065  -0.522301458  3.54787 0.145132  </span></span>
<span><span class="co">#&gt; X0:disp_sss3  -0.762732438    3.064877124  -6.769781219  5.24432 0.803467  </span></span>
<span><span class="co">#&gt; X1:disp_sss3  -1.197156009    3.093850006  -7.260990594  4.86668 0.698795  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Transformed coefficients:</span></span>
<span><span class="co">#&gt;                 estimate standard.error     lower.CI upper.CI    p.value    </span></span>
<span><span class="co">#&gt; (Intercept)   2.68634760     1.29679015   0.14468562  5.22801   0.038309 *  </span></span>
<span><span class="co">#&gt; [X=1]         0.48549900     0.23533589   0.02424913  0.94675   0.039112 *  </span></span>
<span><span class="co">#&gt; amp2         10.97976977    13.95210702 -16.36585750 38.32540   0.431304    </span></span>
<span><span class="co">#&gt; [Z=0]:amp1    9.46895705     5.67256948  -1.64907484 20.58699   0.095067 .  </span></span>
<span><span class="co">#&gt; [Z=1]:amp1    9.30012895     5.50968467  -1.49865458 20.09891   0.091419 .  </span></span>
<span><span class="co">#&gt; [Z=2]:amp1    9.36750743     5.85415491  -2.10642536 20.84144   0.109566    </span></span>
<span><span class="co">#&gt; [X=0]:amp3    2.19426605    20.28508563 -37.56377122 41.95230   0.913860    </span></span>
<span><span class="co">#&gt; [X=1]:amp3    1.92917193    16.45023775 -30.31270161 34.17105   0.906644    </span></span>
<span><span class="co">#&gt; acr2         -1.20576541     1.76855810  -4.67207559  2.26054   0.495379    </span></span>
<span><span class="co">#&gt; [Z=0]:acr1    2.22585319     0.37435804   1.49212491  2.95958 2.7513e-09 ***</span></span>
<span><span class="co">#&gt; [Z=1]:acr1    2.28024396     0.41059257   1.47549732  3.08499 2.7993e-08 ***</span></span>
<span><span class="co">#&gt; [Z=2]:acr1    2.22383142     0.37824032   1.48249402  2.96517 4.1172e-09 ***</span></span>
<span><span class="co">#&gt; [X=0]:acr3    0.35501298     5.08025334  -9.60210060 10.31213   0.944288    </span></span>
<span><span class="co">#&gt; [X=1]:acr3    0.66944942     8.48612696 -15.96305379 17.30195   0.937122    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ***********************</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Zero-Inflation Model </span></span>
<span><span class="co">#&gt; Raw model coefficients:</span></span>
<span><span class="co">#&gt;                  estimate standard.error      lower.CI upper.CI p.value</span></span>
<span><span class="co">#&gt; (Intercept) -1.343058e+01   7.741354e+01 -1.651583e+02 138.2972 0.86227</span></span>
<span><span class="co">#&gt; X1          -7.735231e-01   1.762871e+02 -3.462900e+02 344.7429 0.99650</span></span>
<span><span class="co">#&gt; Z0:zi_rrr1   2.293392e-01   2.286932e+02 -4.480011e+02 448.4597 0.99920</span></span>
<span><span class="co">#&gt; Z1:zi_rrr1   1.916741e-01   1.866871e+02 -3.657083e+02 366.0916 0.99918</span></span>
<span><span class="co">#&gt; Z2:zi_rrr1   2.273302e-01   2.175376e+02 -4.261386e+02 426.5933 0.99917</span></span>
<span><span class="co">#&gt; Z0:zi_sss1  -6.312449e-04   2.114767e+02 -4.144873e+02 414.4860 1.00000</span></span>
<span><span class="co">#&gt; Z1:zi_sss1   6.143921e-02   1.538249e+02 -3.014298e+02 301.5527 0.99968</span></span>
<span><span class="co">#&gt; Z2:zi_sss1  -7.945380e-03   2.202600e+02 -4.317097e+02 431.6938 0.99997</span></span>
<span><span class="co">#&gt; X0:zi_rrr2  -1.443119e-02   1.168461e+02 -2.290286e+02 228.9997 0.99990</span></span>
<span><span class="co">#&gt; X1:zi_rrr2  -3.012615e-03   2.251920e+02 -4.413712e+02 441.3652 0.99999</span></span>
<span><span class="co">#&gt; X0:zi_sss2  -5.045658e-01   1.829841e+02 -3.591468e+02 358.1377 0.99780</span></span>
<span><span class="co">#&gt; X1:zi_sss2  -2.338049e-01   2.622215e+02 -5.141786e+02 513.7110 0.99929</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Transformed coefficients:</span></span>
<span><span class="co">#&gt;                  estimate standard.error      lower.CI  upper.CI p.value</span></span>
<span><span class="co">#&gt; (Intercept) -1.343058e+01   7.741354e+01 -1.651583e+02  138.2972 0.86227</span></span>
<span><span class="co">#&gt; [X=1]       -7.735231e-01   1.762871e+02 -3.462900e+02  344.7429 0.99650</span></span>
<span><span class="co">#&gt; [Z=0]:amp1   2.293401e-01   2.287649e+02 -4.481417e+02  448.6004 0.99920</span></span>
<span><span class="co">#&gt; [Z=1]:amp1   2.012803e-01   3.389313e+02 -6.640918e+02  664.4944 0.99953</span></span>
<span><span class="co">#&gt; [Z=2]:amp1   2.274690e-01   3.713657e+02 -7.276360e+02  728.0910 0.99951</span></span>
<span><span class="co">#&gt; [X=0]:amp2   5.047722e-01   2.902484e+02 -5.683717e+02  569.3812 0.99861</span></span>
<span><span class="co">#&gt; [X=1]:amp2   2.338243e-01   3.402040e+02 -6.665539e+02  667.0215 0.99945</span></span>
<span><span class="co">#&gt; [Z=0]:acr1   2.752444e-03   9.217710e+02 -1.806635e+03 1806.6407 1.00000</span></span>
<span><span class="co">#&gt; [Z=1]:acr1  -3.101927e-01   1.431672e+03 -2.806335e+03 2805.7150 0.99983</span></span>
<span><span class="co">#&gt; [Z=2]:acr1   3.493661e-02   1.372330e+03 -2.689682e+03 2689.7514 0.99998</span></span>
<span><span class="co">#&gt; [X=0]:acr2   1.599390e+00   4.908810e+02 -9.605096e+02  963.7084 0.99740</span></span>
<span><span class="co">#&gt; [X=1]:acr2   1.583681e+00   1.415509e+03 -2.772762e+03 2775.9295 0.99911</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="using-predict-cosinor-glmm-r">Using: ‘predict.cosinor.glmm.R’<a class="anchor" aria-label="anchor" href="#using-predict-cosinor-glmm-r"></a>
</h2>
<p>The predict.cosinor.glmm() function allows users to generate
predicted values given a time variable and optional covariates. It is
used in the plot.cosinor.glmm() function to generate the fitted line
based on acosinor.glmm object.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">vitamind</span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cosinor.glmm.html">cosinor.glmm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">X</span>, group <span class="op">=</span> <span class="cn">NA</span>, period <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">vitamind</span><span class="op">)</span></span>
<span><span class="va">df_predicted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>, newdata <span class="op">=</span> <span class="va">vitamind</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Rex Parsons, Oliver Jayasinghe.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
