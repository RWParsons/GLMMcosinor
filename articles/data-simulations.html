<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="GLMMcosinor">
<title>data-simulations • GLMMcosinor</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="data-simulations">
<meta property="og:description" content="GLMMcosinor">
<meta property="og:image" content="https://rwparsons.github.io/GLMMcosinor/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">GLMMcosinor</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/GLMMcosinor.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/data-simulations.html">data-simulations</a>
    <a class="dropdown-item" href="../articles/mixed-models.html">mixed-models</a>
    <a class="dropdown-item" href="../articles/model-specification.html">model-specification</a>
    <a class="dropdown-item" href="../articles/model-visualisations.html">model-visualisations</a>
    <a class="dropdown-item" href="../articles/multiple-components.html">multiple-components</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/RWParsons/GLMMcosinor/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="data-simulations_files/htmlwidgets-1.6.2/htmlwidgets.js"></script><link href="data-simulations_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="data-simulations_files/datatables-binding-0.29/datatables.js"></script><link href="data-simulations_files/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="data-simulations_files/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="data-simulations_files/dt-core-1.13.4/js/jquery.dataTables.min.js"></script><link href="data-simulations_files/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="data-simulations_files/crosstalk-1.2.0/js/crosstalk.min.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>data-simulations</h1>
                        <h4 data-toc-skip class="author">Oliver
Jayasinghe and Rex Parsons</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/RWParsons/GLMMcosinor/blob/HEAD/vignettes/data-simulations.Rmd" class="external-link"><code>vignettes/data-simulations.Rmd</code></a></small>
      <div class="d-none name"><code>data-simulations.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RWParsons/GLMMcosinor" class="external-link">GLMMcosinor</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="using-simulate_cosinor-r">Using: ‘simulate_cosinor.R’<a class="anchor" aria-label="anchor" href="#using-simulate_cosinor-r"></a>
</h2>
<p><code>simulate_cosinor</code> allows users to simulate circadian data
from Gaussian, Gamma, Binomial, or Poisson distributions. It also
supports generation of multi-component data, as well as simulation of
grouped data with two levels.</p>
<div class="section level3">
<h3 id="understanding-the-inputs-for-a-simple-model">Understanding the inputs for a simple model<a class="anchor" aria-label="anchor" href="#understanding-the-inputs-for-a-simple-model"></a>
</h3>
<p><code>n</code> specifies the number of datapoints.</p>
<p><code>mesor</code>, <code>amp</code>, and <code>acro</code> represent
the parameters that will be used to simulate the dataset. Note that
<code>acro</code> should be expressed in units of radians.</p>
<p><code>period</code> determines the period of the dataset</p>
<p><code>n_components</code> corresponds to the number of components in
the simulated dataset. Details about how to specify a multi-component
model are included later in this vignette</p>
<p>The <code>family</code> argument determines the distribution that the
data is simulated from. Currently, <code>simulate_cosinor</code>
supports simulations from Gaussian, Gamma, Binomial, and Poisson
distributions:</p>
<ul>
<li><p><code>family = 'gaussian'</code></p></li>
<li><p><code>family = 'gamma'</code></p></li>
<li><p><code>family = 'binomial'</code></p></li>
<li><p><code>family = 'poisson'</code></p></li>
</ul>
<p>Note that the <code>…</code> parameter controls extra arguments such
as standard deviation, and the shape parameter for a Gamma
distribution:</p>
<ul>
<li><p><code>sd</code> controls the standard deviation when sampling
from a normal distribution. <code>sd</code> is set to 1 by
default</p></li>
<li><p><code>alpha</code> controls the shape parameter for the Gamma
distribution. <code>alpha</code> is set to 1 by default</p></li>
</ul>
<p><code>n_period</code> is the number of periods that are simulated. By
default, the maximum period supplied defines the upper limit of the time
vector used in the simulation. Thus, increasing <code>n_period</code>
increases the number of cycles that are simulated.</p>
<p>Consider the following example of a single-component Poisson data-set
with no grouping variable:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">testdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_cosinor.html">simulate_cosinor</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  mesor <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  amp <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  acro <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>  period <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  n_period <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"poisson"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">testdata</span></span></code></pre></div>
<p>Now, let’s fit a <code><a href="../reference/cosinor.glmm.html">cosinor.glmm()</a></code> model to this simulated
dataset to see how it matches with our original parameters:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cosinor.glmm.html">cosinor.glmm</a></span><span class="op">(</span></span>
<span>  <span class="va">Y</span> <span class="op">~</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">times</span>,</span>
<span>    n_components <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    period <span class="op">=</span> <span class="fl">12</span></span>
<span>  <span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">testdata</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">object</span>, superimpose.data <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="simulating-grouped-cosinor-data">Simulating grouped cosinor data<a class="anchor" aria-label="anchor" href="#simulating-grouped-cosinor-data"></a>
</h3>
<p>The <code><a href="../reference/simulate_cosinor.html">simulate_cosinor()</a></code> function can simulate grouped
data from two levels with their own parameters when
<code>beta.group = TRUE</code>. The reference group is specified by the
parameters <code>mesor</code>, <code>amp</code>, <code>acro</code>. The
treatment group is specified in the same manner, but with the
<code>beta</code> prefix. For example:</p>
<ul>
<li><p><code>beta.mesor</code></p></li>
<li><p><code>beta.amp</code></p></li>
<li><p><code>beta.acro</code></p></li>
</ul>
<p>Similarly, the standard deviation (<code>sd)</code> for the Gaussian
distribution or the <code>alpha</code> parameter for the Gamma
distribution are specified as:</p>
<ul>
<li><p><code>beta.sd</code> (1 by default)</p></li>
<li><p><code>beta.alpha</code> (1 by default)</p></li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/simulate_cosinor.html">simulate_cosinor</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  mesor <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  amp <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  acro <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>  period <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  beta.group <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  beta.mesor <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>  beta.amp <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  beta.acro <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  n_period <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  n_components <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"poisson"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-1cc9491da37ccb63fee0" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-1cc9491da37ccb63fee0">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200"],[3.226878536151942,-0.4116208646407147,2.204818029668604,-0.3652327492175546,-0.4323277036189724,3.440515389480124,-0.3928189104332068,2.593009168388106,-0.9715677491324292,-1.7759386445064,1.610299928397989,2.264559568449527,0.9301177238624035,0.6612876940252632,2.642839918620978,-0.6024185936578088,2.038695252063951,1.988441755948642,-0.3727936720420469,-0.07962680135346267,2.13433364949601,3.344122411249176,-0.08990961807010794,1.914831943057287,3.207726861779756,3.208094785511866,0.7058268844766149,3.007828945092716,0.8167786606699863,-0.4325910443262556,-1.540587647113934,0.1665896818348742,-1.760604171747248,-0.4623192537191374,3.250406781886966,-1.868246736954522,2.084615942071991,-0.6474062306752573,1.980570033941519,-1.121757214182675,2.553211293863811,3.165250708326135,1.675066790077198,4.404738952033963,2.657147212357791,-0.1278500481579641,1.867135056379745,2.794866916347286,0.6108131776706833,1.250254320939095,-0.319724768559849,1.08728540448939,2.105568963514355,-1.050668442438764,1.548284628536028,-1.587229105512855,0.314196516136714,1.083439610183934,0.1964095845927107,-0.1806655781029803,-2.505282999423007,2.752850632890019,3.0978532840951,0.5312207852947249,-0.8162737864147944,1.168959564912111,2.058238685004909,2.965789671584027,4.175672272311187,2.910340965188889,0.3002712015156462,1.667071975005503,-0.317379939313041,-1.096289088472031,3.43033802311963,1.520685064471939,-0.02507289461208567,1.573223641399268,2.30875771431662,0.05528073469011763,3.74212901201774,-0.3623855024492838,-0.5086367810484025,2.542403671705582,3.881955963936159,-1.77840787975118,3.923476490647073,-0.7484160423434825,1.153018227781179,1.113567554609344,1.383557140655572,1.020293010820942,4.328606621896554,-0.438446711995718,2.459712877093525,0.5881130292887067,2.852211607971317,1.909048751864994,-0.5310724693077185,1.989616828233646,0.7949642704959192,-0.6560483186123636,1.122246405228772,0.7833000105001857,0.8324139058135608,1.348014866125208,-0.7670890820774678,2.490161431326973,-0.6401798708743431,-0.20106607316633,0.6923894179189227,1.888790929769202,-1.000176997492881,0.8363192754782047,-1.783232819354995,1.758435522269393,0.8539546881736613,-1.199799579286497,1.096654657368502,1.572709783651011,1.173121135270871,-0.9674981223898687,-0.8605412718580556,-1.090921913399267,0.4104583001929265,0.817341718978848,0.5335444572229764,0.3863439498899923,1.840732921815174,-0.4082464499329888,-1.196620086910016,0.7795362036498454,-0.3882728660076474,2.135247745782941,1.787095866619942,-0.7099355009699229,0.4802346189379055,0.3360711880450662,0.2414915548804084,-1.436493605817195,-0.8082779098318287,1.522434454849039,1.518149094259149,1.432591783792125,0.1674805965981421,-0.1799943022657197,-0.2650852499874251,-2.408139928343972,0.3076783615415489,-1.026325425919376,0.08358219539029371,1.10215391214894,1.700428777615109,-1.436992290951788,1.374378957653703,-1.001415643438036,0.7398248896414151,-0.4765956472300388,-0.1346998681768751,0.3395592233304606,0.2596865901975336,-0.04708408870211767,1.56445736231687,-0.279591292899086,-0.2528068782973323,0.3118142341218733,-0.6300227844668925,2.226387363914319,0.1416215712594037,-0.593461071962037,-0.9569582011207243,-0.193920314282059,0.04523417898833099,-1.021344517237129,0.2692781005666094,1.233616679052639,0.4748711021274479,-0.3074117463565127,3.012696214358171,-0.4652104141738471,0.4187982979353326,1.859854809945868,0.3366703382940396,-0.2541416789125324,0.1255146370170813,1.529170643917719,0.3813024574767871,0.4890394958212362,-0.6775501822128486,3.071238853165105,-1.049384131484212,0.0215291055466172,-0.6009086065434845,-1.126252888804127,-0.3182552304623806,0.2757303267562541,0.1200499502686247,-0.1557576358225419,2.610162413387465,-1.63100511930908],[25.4406938161701,30.37826356105506,0.7633308777585626,34.32884608581662,22.52457971312106,1.264195290394127,18.50112715177238,24.68260093219578,18.99758890271187,6.951698446646333,23.02078020852059,1.543362781405449,10.53398104291409,31.84326005727053,4.388021335937083,32.67534174397588,28.23191081453115,0.4965567514300346,21.05434089805931,8.186299692839384,35.92073675896972,26.10057159885764,18.03276407998055,24.50206303596497,1.721506068482995,26.30477885808796,9.777356542646885,3.040859872475266,15.5434028506279,10.87284484226257,19.89508180506527,21.48181754071265,31.5538274673745,10.4904699632898,26.54610388353467,17.94376762211323,11.04684815648943,9.186416074633598,26.79143912997097,31.59614607039839,24.64673055242747,27.7490061884746,10.75318849738687,2.172965808771551,27.25342786498368,6.308846639469266,18.80750052351505,16.51245848089457,18.06030185054988,4.681156539358199,9.222353090532124,35.42937975469977,0.7040503704920411,18.60136298742145,13.53678363841027,21.40874899551272,23.02395794726908,16.3780278917402,19.53666615206748,33.39365085493773,8.452214791439474,12.12603326048702,28.14492488186806,11.45407264586538,30.84189432766289,27.95573763269931,24.68812253605574,14.03803265467286,12.82499022502452,15.65508296806365,22.15054794587195,28.41046359110624,18.61731748748571,10.32836152520031,13.97826199885458,4.812614729627967,18.86129039805382,22.83226012531668,24.01702237408608,11.39553008135408,0.5198196927085519,7.387475604191422,30.19874864257872,12.21215712279081,1.643577746115625,10.60035980679095,27.37197989411652,20.81680744327605,17.11612200737,22.48452501185238,3.965946142561734,29.87002719752491,12.51288771349937,7.378515458665788,24.91389816720039,19.50822347961366,14.44463051296771,16.04994504712522,11.92671438585967,15.6238715518266,25.4406938161701,30.37826356105506,0.7633308777585626,34.32884608581662,22.52457971312106,1.264195290394127,18.50112715177238,24.68260093219578,18.99758890271187,6.951698446646333,23.02078020852059,1.543362781405449,10.53398104291409,31.84326005727053,4.388021335937083,32.67534174397588,28.23191081453115,0.4965567514300346,21.05434089805931,8.186299692839384,35.92073675896972,26.10057159885764,18.03276407998055,24.50206303596497,1.721506068482995,26.30477885808796,9.777356542646885,3.040859872475266,15.5434028506279,10.87284484226257,19.89508180506527,21.48181754071265,31.5538274673745,10.4904699632898,26.54610388353467,17.94376762211323,11.04684815648943,9.186416074633598,26.79143912997097,31.59614607039839,24.64673055242747,27.7490061884746,10.75318849738687,2.172965808771551,27.25342786498368,6.308846639469266,18.80750052351505,16.51245848089457,18.06030185054988,4.681156539358199,9.222353090532124,35.42937975469977,0.7040503704920411,18.60136298742145,13.53678363841027,21.40874899551272,23.02395794726908,16.3780278917402,19.53666615206748,33.39365085493773,8.452214791439474,12.12603326048702,28.14492488186806,11.45407264586538,30.84189432766289,27.95573763269931,24.68812253605574,14.03803265467286,12.82499022502452,15.65508296806365,22.15054794587195,28.41046359110624,18.61731748748571,10.32836152520031,13.97826199885458,4.812614729627967,18.86129039805382,22.83226012531668,24.01702237408608,11.39553008135408,0.5198196927085519,7.387475604191422,30.19874864257872,12.21215712279081,1.643577746115625,10.60035980679095,27.37197989411652,20.81680744327605,17.11612200737,22.48452501185238,3.965946142561734,29.87002719752491,12.51288771349937,7.378515458665788,24.91389816720039,19.50822347961366,14.44463051296771,16.04994504712522,11.92671438585967,15.6238715518266],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Y<\/th>\n      <th>times<\/th>\n      <th>group<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Conditional Model </span></span>
<span><span class="co">#&gt; Raw model coefficients:</span></span>
<span><span class="co">#&gt;                      estimate standard.error     lower.CI upper.CI    p.value</span></span>
<span><span class="co">#&gt; (Intercept)       1.066838416    0.096812336  0.877089723  1.25659 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group1           -0.835725017    0.136913319 -1.104070191 -0.56738 1.0342e-09</span></span>
<span><span class="co">#&gt; group0:main_rrr1  0.846630116    0.132775811  0.586394310  1.10687 1.8131e-10</span></span>
<span><span class="co">#&gt; group1:main_rrr1  0.486065498    0.132775811  0.225829691  0.74630 0.00025143</span></span>
<span><span class="co">#&gt; group0:main_sss1  1.836724759    0.140914296  1.560537813  2.11291 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group1:main_sss1 -0.005141572    0.140914296 -0.281328518  0.27105 0.97089386</span></span>
<span><span class="co">#&gt;                     </span></span>
<span><span class="co">#&gt; (Intercept)      ***</span></span>
<span><span class="co">#&gt; group1           ***</span></span>
<span><span class="co">#&gt; group0:main_rrr1 ***</span></span>
<span><span class="co">#&gt; group1:main_rrr1 ***</span></span>
<span><span class="co">#&gt; group0:main_sss1 ***</span></span>
<span><span class="co">#&gt; group1:main_sss1    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Transformed coefficients:</span></span>
<span><span class="co">#&gt;                   estimate standard.error    lower.CI upper.CI    p.value    </span></span>
<span><span class="co">#&gt; (Intercept)     1.06683842     0.09681234  0.87708972  1.25659 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=1]      -0.83572502     0.13691332 -1.10407019 -0.56738 1.0342e-09 ***</span></span>
<span><span class="co">#&gt; [group=0]:amp1  2.02245900     0.13826009  1.75147420  2.29344 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=1]:amp1  0.48609269     0.18782663  0.11795927  0.85423  0.0096539 ** </span></span>
<span><span class="co">#&gt; [group=0]:acr1  1.13887745     0.06572451  1.01005978  1.26770 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=1]:acr1 -0.01057755     0.41006707 -0.81429424  0.79314  0.9794211    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; Called from: predict.cosinor.glmm(object, newdata = newdata_processed, type = type, </span></span>
<span><span class="co">#&gt;     se.fit = TRUE)</span></span>
<span><span class="co">#&gt; debug: nd &lt;- update_formula_and_data(data = newdata, formula = eval(object$cosinor.glmm.calls$cosinor.glmm$formula))$newdata</span></span>
<span><span class="co">#&gt; debug: return(stats::predict(object$fit, newdata = nd, ...))</span></span></code></pre>
<p><img src="data-simulations_files/figure-html/unnamed-chunk-5-2.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="simulating-multi-component-cosinor-data">Simulating multi-component cosinor data<a class="anchor" aria-label="anchor" href="#simulating-multi-component-cosinor-data"></a>
</h3>
<p>To simulate multi-component data with the number of components
corresponding to <code>n_components</code> , specify a vector of values
for the parameter inputs, <code>amp</code>, <code>acro</code>, and
<code>period</code>. Since only one <code>mesor</code> is provided for a
multi-component cosinor curve, the <code>mesor</code> argument in
<code>simualte_cosinor</code> will only accept single-element inputs.
For example:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">testdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_cosinor.html">simulate_cosinor</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  mesor <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  amp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  acro <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>  n_components <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  n_period <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"poisson"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">testdata</span></span>
<span><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cosinor.glmm.html">cosinor.glmm</a></span><span class="op">(</span></span>
<span>  <span class="va">Y</span> <span class="op">~</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">times</span>,</span>
<span>    n_components <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">6</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">testdata</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">object</span>, superimpose.data <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>In this example:</p>
<ul>
<li><p><code>mesor = 1</code> suggests that the intercept of the overall
cosinor curve (accounting for all components) is 1</p></li>
<li><p><code>amp=c(0.2,1)</code> indicates that the amplitude of the
first component is 0.2, and the second is 1</p></li>
<li><p><code>acro = c(1.2, 2)</code> indicates that the acrophase of the
first component is 1.2 radians, and the second is 2 radians</p></li>
<li><p><code>period = c(12, 6)</code> indicates that the period of the
first component is 12 units, and the second is 6 units.</p></li>
<li><p><code>n_components = 2</code>, because we are specifying a
two-component dataset</p></li>
</ul>
<p>To simulate a dataset with more than two components, specify more
elements in the vector inputs for these parameters. Ensure that the
number of inputs for each parameter corresponds to the number of
components specified in <code>n_components</code>. For example, if
<code>n_components = 3</code>, then <code>amp</code>, <code>acro</code>,
<code>period</code> must all have 3 elements corresponding to each of
the three components.</p>
<p>The following are examples of a multi-component cosinor dataset with
mutliple groups. The first one is from a Poisson distribution, and the
second is from a Gamma distribution</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">testdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_cosinor.html">simulate_cosinor</a></span><span class="op">(</span><span class="fl">100</span>,</span>
<span>  mesor <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  amp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  acro <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.5</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  beta.mesor <span class="op">=</span> <span class="fl">4.4</span>,</span>
<span>  beta.amp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>  beta.acro <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1.5</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>  period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">6</span>, <span class="fl">8</span><span class="op">)</span>,</span>
<span>  n_period <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  n_components <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cosinor.glmm.html">cosinor.glmm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">group</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">times</span>,</span>
<span>  n_components <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">6</span>, <span class="fl">8</span><span class="op">)</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"group"</span></span>
<span><span class="op">)</span>, data <span class="op">=</span> <span class="va">testdata</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Conditional Model </span></span>
<span><span class="co">#&gt; Raw model coefficients:</span></span>
<span><span class="co">#&gt;                      estimate standard.error     lower.CI upper.CI    p.value</span></span>
<span><span class="co">#&gt; (Intercept)       6.997428114    0.003254740  6.991048942  7.00381 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group1           -2.577613217    0.018156405 -2.613199118 -2.54203 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group0:main_rrr1  0.054761458    0.004179542  0.046569706  0.06295 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group1:main_rrr1  1.065605065    0.019473598  1.027437514  1.10377 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group0:main_sss1  0.080044479    0.004521042  0.071183399  0.08891 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group1:main_sss1  1.655275883    0.024019046  1.608199419  1.70235 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group0:main_rrr2  0.025918594    0.004188035  0.017710195  0.03413 6.0653e-10</span></span>
<span><span class="co">#&gt; group1:main_rrr2  0.075171990    0.014612593  0.046531834  0.10381 2.6848e-07</span></span>
<span><span class="co">#&gt; group0:main_sss2  0.399919619    0.004277659  0.391535562  0.40830 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group1:main_sss2 -0.985945511    0.016330028 -1.017951778 -0.95394 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group0:main_rrr3  0.495390110    0.004297035  0.486968075  0.50381 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group1:main_rrr3  0.230793094    0.009534341  0.212106129  0.24948 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group0:main_sss3  0.048491315    0.004315467  0.040033155  0.05695 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group1:main_sss3 -0.331473444    0.013152998 -0.357252847 -0.30569 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt;                     </span></span>
<span><span class="co">#&gt; (Intercept)      ***</span></span>
<span><span class="co">#&gt; group1           ***</span></span>
<span><span class="co">#&gt; group0:main_rrr1 ***</span></span>
<span><span class="co">#&gt; group1:main_rrr1 ***</span></span>
<span><span class="co">#&gt; group0:main_sss1 ***</span></span>
<span><span class="co">#&gt; group1:main_sss1 ***</span></span>
<span><span class="co">#&gt; group0:main_rrr2 ***</span></span>
<span><span class="co">#&gt; group1:main_rrr2 ***</span></span>
<span><span class="co">#&gt; group0:main_sss2 ***</span></span>
<span><span class="co">#&gt; group1:main_sss2 ***</span></span>
<span><span class="co">#&gt; group0:main_rrr3 ***</span></span>
<span><span class="co">#&gt; group1:main_rrr3 ***</span></span>
<span><span class="co">#&gt; group0:main_sss3 ***</span></span>
<span><span class="co">#&gt; group1:main_sss3 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Transformed coefficients:</span></span>
<span><span class="co">#&gt;                    estimate standard.error     lower.CI upper.CI    p.value    </span></span>
<span><span class="co">#&gt; (Intercept)     6.997428114    0.003254740  6.991048942  7.00381 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=1]      -2.577613217    0.018156405 -2.613199118 -2.54203 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=0]:amp1  0.096984204    0.003820554  0.089496055  0.10447 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=1]:amp1  1.968616876    0.027901743  1.913930465  2.02330 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=0]:amp2  0.400758625    0.006335684  0.388340912  0.41318 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=1]:amp2  0.988807048    0.017062843  0.955364490  1.02225 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=0]:amp3  0.497757741    0.005305406  0.487359337  0.50816 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=1]:amp3  0.403906049    0.013303579  0.377831514  0.42998 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=0]:acr1  0.970795613    0.037912906  0.896487682  1.04510 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=1]:acr1  0.998818273    0.013395729  0.972563127  1.02507 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=0]:acr2  1.506077329    0.013780613  1.479067824  1.53309 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=1]:acr2 -1.494699996    0.015525520 -1.525129456 -1.46427 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=0]:acr3  0.097574265    0.013283893  0.071538313  0.12361 2.0529e-13 ***</span></span>
<span><span class="co">#&gt; [group=1]:acr3 -0.962582010    0.030065354 -1.021509021 -0.90365 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">object</span>,</span>
<span>  superimpose.data <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  x_str <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>  predict.ribbon <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Called from: predict.cosinor.glmm(object, newdata = newdata_processed, type = type, </span></span>
<span><span class="co">#&gt;     se.fit = TRUE)</span></span>
<span><span class="co">#&gt; debug: nd &lt;- update_formula_and_data(data = newdata, formula = eval(object$cosinor.glmm.calls$cosinor.glmm$formula))$newdata</span></span>
<span><span class="co">#&gt; debug: return(stats::predict(object$fit, newdata = nd, ...))</span></span></code></pre></div>
<p><img src="data-simulations_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">testdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_cosinor.html">simulate_cosinor</a></span><span class="op">(</span><span class="fl">500</span>,</span>
<span>  mesor <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  amp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  acro <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pi</span>, <span class="va">pi</span> <span class="op">/</span> <span class="fl">2</span>, <span class="va">pi</span><span class="op">)</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  beta.mesor <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  beta.amp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>  beta.acro <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pi</span> <span class="op">/</span> <span class="fl">2</span>, <span class="va">pi</span>, <span class="va">pi</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  beta.alpha <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"gamma"</span>,</span>
<span>  period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">6</span>, <span class="fl">8</span><span class="op">)</span>,</span>
<span>  n_period <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  n_components <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cosinor.glmm.html">cosinor.glmm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">group</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">times</span>,</span>
<span>  n_components <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">6</span>, <span class="fl">8</span><span class="op">)</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"group"</span></span>
<span><span class="op">)</span>, data <span class="op">=</span> <span class="va">testdata</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">Gamma</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Conditional Model </span></span>
<span><span class="co">#&gt; Raw model coefficients:</span></span>
<span><span class="co">#&gt;                      estimate standard.error     lower.CI upper.CI    p.value</span></span>
<span><span class="co">#&gt; (Intercept)       0.994051443    0.028663782  0.937871462  1.05023 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group1            1.010952168    0.040539345  0.931496511  1.09041 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group0:main_rrr1 -0.412885950    0.041330033 -0.493891327 -0.33188 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group1:main_rrr1  0.005107405    0.041219444 -0.075681220  0.08590   0.901388</span></span>
<span><span class="co">#&gt; group0:main_sss1  0.013438840    0.040746563 -0.066422956  0.09330   0.741540</span></span>
<span><span class="co">#&gt; group1:main_sss1  0.216028399    0.040757728  0.136144721  0.29591 1.1561e-07</span></span>
<span><span class="co">#&gt; group0:main_rrr2 -0.015501477    0.040090486 -0.094077385  0.06307   0.699006</span></span>
<span><span class="co">#&gt; group1:main_rrr2 -0.157328560    0.040372820 -0.236457833 -0.07820 9.7435e-05</span></span>
<span><span class="co">#&gt; group0:main_sss2  0.473779543    0.041158159  0.393111033  0.55445 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group1:main_sss2 -0.014799905    0.040743045 -0.094654806  0.06505   0.716418</span></span>
<span><span class="co">#&gt; group0:main_rrr3 -0.576912300    0.040649268 -0.656583401 -0.49724 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group1:main_rrr3 -0.072866337    0.040914135 -0.153056568  0.00732   0.074919</span></span>
<span><span class="co">#&gt; group0:main_sss3 -0.051531686    0.041579095 -0.133025214  0.02996   0.215210</span></span>
<span><span class="co">#&gt; group1:main_sss3  0.243734559    0.041143423  0.163094931  0.32437 3.1416e-09</span></span>
<span><span class="co">#&gt;                     </span></span>
<span><span class="co">#&gt; (Intercept)      ***</span></span>
<span><span class="co">#&gt; group1           ***</span></span>
<span><span class="co">#&gt; group0:main_rrr1 ***</span></span>
<span><span class="co">#&gt; group1:main_rrr1    </span></span>
<span><span class="co">#&gt; group0:main_sss1    </span></span>
<span><span class="co">#&gt; group1:main_sss1 ***</span></span>
<span><span class="co">#&gt; group0:main_rrr2    </span></span>
<span><span class="co">#&gt; group1:main_rrr2 ***</span></span>
<span><span class="co">#&gt; group0:main_sss2 ***</span></span>
<span><span class="co">#&gt; group1:main_sss2    </span></span>
<span><span class="co">#&gt; group0:main_rrr3 ***</span></span>
<span><span class="co">#&gt; group1:main_rrr3 .  </span></span>
<span><span class="co">#&gt; group0:main_sss3    </span></span>
<span><span class="co">#&gt; group1:main_sss3 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Transformed coefficients:</span></span>
<span><span class="co">#&gt;                   estimate standard.error    lower.CI upper.CI    p.value    </span></span>
<span><span class="co">#&gt; (Intercept)     0.99405144     0.02866378  0.93787146  1.05023 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=1]       1.01095217     0.04053935  0.93149651  1.09041 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=0]:amp1  0.41310460     0.04134468  0.33207051  0.49414 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=1]:amp1  0.21608877     0.05761611  0.10316327  0.32901 0.00017649 ***</span></span>
<span><span class="co">#&gt; [group=0]:amp2  0.47403307     0.05828446  0.35979762  0.58827 4.1847e-16 ***</span></span>
<span><span class="co">#&gt; [group=1]:amp2  0.15802314     0.05770409  0.04492521  0.27112 0.00617185 ** </span></span>
<span><span class="co">#&gt; [group=0]:amp3  0.57920922     0.05249035  0.47633002  0.68209 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=1]:amp3  0.25439347     0.05844103  0.13985116  0.36894 1.3429e-05 ***</span></span>
<span><span class="co">#&gt; [group=0]:acr1  3.10905559     0.09867395  2.91565820  3.30245 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=1]:acr1  1.54715844     0.27004920  1.01787173  2.07645 1.0092e-08 ***</span></span>
<span><span class="co">#&gt; [group=0]:acr2  1.60350341     0.11825832  1.37172136  1.83529 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=1]:acr2 -3.04779863     0.36419895 -3.76161544 -2.33398 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=0]:acr3 -3.05250583     0.10220503 -3.25282401 -2.85219 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=1]:acr3  1.86129666     0.23054284  1.40944099  2.31315 6.8289e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">object</span>,</span>
<span>  superimpose.data <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  x_str <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>  predict.ribbon <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Called from: predict.cosinor.glmm(object, newdata = newdata_processed, type = type, </span></span>
<span><span class="co">#&gt;     se.fit = TRUE)</span></span>
<span><span class="co">#&gt; debug: nd &lt;- update_formula_and_data(data = newdata, formula = eval(object$cosinor.glmm.calls$cosinor.glmm$formula))$newdata</span></span>
<span><span class="co">#&gt; debug: return(stats::predict(object$fit, newdata = nd, ...))</span></span></code></pre></div>
<p><img src="data-simulations_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Rex Parsons, Oliver Jayasinghe, Nicole White.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
