<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Given an outcome and time variable, fit the cosinor model with optional
covariate effects."><title>Fit cosinor model with {glmmTMB} — cosinor.glmm • GLMMcosinor</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit cosinor model with {glmmTMB} — cosinor.glmm"><meta property="og:description" content="Given an outcome and time variable, fit the cosinor model with optional
covariate effects."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">GLMMcosinor</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/introduction-to-GLMMcosinor.html">Introduction to GLMMcosinor</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/RWParsons/GLMMcosinor/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Fit cosinor model with <code>{glmmTMB}</code></h1>
      <small class="dont-index">Source: <a href="https://github.com/RWParsons/GLMMcosinor/blob/HEAD/R/cosinor.glmm.R" class="external-link"><code>R/cosinor.glmm.R</code></a></small>
      <div class="d-none name"><code>cosinor.glmm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Given an outcome and time variable, fit the cosinor model with optional
covariate effects.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cosinor.glmm</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  family <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  quietly <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dispformula <span class="op">=</span> <span class="op">~</span><span class="fl">1</span>,</span>
<span>  ziformula <span class="op">=</span> <span class="op">~</span><span class="fl">0</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formula</dt>
<dd><p>Formula specifying the model. Indicate the time variable with
<code><a href="https://rdrr.io/r/stats/time.html" class="external-link">time()</a></code> and covariate effects on the amplitude and acrophase with
<code>amp.acro()</code>. See details for more information.</p></dd>


<dt>data</dt>
<dd><p>Data frame where variable can be found</p></dd>


<dt>family</dt>
<dd><p>a family function, see <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">?family</a></code> and <code><a href="https://rdrr.io/pkg/glmmTMB/man/nbinom2.html" class="external-link">?glmmTMB::nbinom2</a></code></p></dd>


<dt>quietly</dt>
<dd><p>controls whether messages from amp.acro are displayed. TRUE by default</p></dd>


<dt>dispformula</dt>
<dd><p>Formula specifying a dispersion model (optional). Use the same format as the main formula</p></dd>


<dt>ziformula</dt>
<dd><p>Formula specifying a zero-inflation model (optional). Use the same format as the main formula</p></dd>


<dt>...</dt>
<dd><p>optional additional arguments passed to glmmTMB::glmmTMB()</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This defines special functions that are used in the formula to
indicate the time variable and which covariates effect the amplitude. To
indicate the time variable wrap the name of it in the function
<code><a href="https://rdrr.io/r/stats/time.html" class="external-link">time()</a></code>. To indicate a variable which affects the
acrophase/amplitude, wrap the name in <code>amp.acro()</code>. This will then do
all the transformations for you. See examples for usage.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Tong, YL. Parameter Estimation in Studying Circadian Rhythms, Biometrics (1976). 32(1):85--94.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">cosinor.glmm</span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span> <span class="op">+</span> <span class="fu">amp.acro</span><span class="op">(</span><span class="va">time</span>,</span></span>
<span class="r-in"><span>  n_components <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>  group <span class="op">=</span> <span class="st">"X"</span>,</span></span>
<span class="r-in"><span>  period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">8</span>, <span class="fl">9</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span>, data <span class="op">=</span> <span class="va">vitamind</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Package version inconsistency detected.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> TMB was built with Matrix version 1.5.3</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Current Matrix version is 1.5.1</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Please re-install 'TMB' from source using install.packages('TMB', type = 'source') or ask CRAN for a binary version of 'TMB' matching CRAN's 'Matrix' package</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Conditional Model </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Raw formula: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y ~ X + X:main_rrr1 + X:main_sss1 + X:main_rrr2 + X:main_sss2 + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     X:main_rrr3 + X:main_sss3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x5578bce70b10&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Raw Coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  (Intercept)           X1 X0:main_rrr1 X1:main_rrr1 X0:main_sss1 X1:main_sss1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   29.7207882    5.0427216    0.5449958   25.7817398    2.1843787    4.2067454 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X0:main_rrr2 X1:main_rrr2 X0:main_sss2 X1:main_sss2 X0:main_rrr3 X1:main_rrr3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    8.3651420   -0.4844171   -3.6044821   24.2788845   -8.3800373  -20.4904692 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X0:main_sss3 X1:main_sss3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    8.7132257  -34.3472358 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Transformed Coefficients: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)       [X=1]  [X=0]:amp1  [X=1]:amp1  [X=0]:amp2  [X=1]:amp2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  29.7207882   5.0427216   2.2513398  26.1226877   9.1086713  24.2837166 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [X=0]:amp3  [X=1]:amp3  [X=0]:acr1  [X=1]:acr1  [X=0]:acr2  [X=1]:acr2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  12.0890582  39.9948989  -1.3262912  -0.1617423   0.4068516  -1.5907459 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [X=0]:acr3  [X=1]:acr3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -2.3367046   2.1086886 </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Rex Parsons, Oliver Jayasinghe.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

